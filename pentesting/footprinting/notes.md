# Footprinting

### FTP

```shell
  ftp <ip>
  anonymous:anonymous
```

---

### SMB

```shell
  smbclient -N -L //<ip>
  smbclient -N //<ip>/<share_name>

  samrdump.py <ip>

  smbmap -H <ip>

  crackmapexec smb <ip> --shares -u '' -p ''

  //commands
  get <filename>
  !cat <filename>
  !ls
```

---

### RpcClient

```shell
  rpcclient -U "" <ip>

  //client enumeration
  srvinfo
  enumdomains
  querydomaininfo
  netshareenumall
  netsharegetinfo <share_name>
  
  //user enumeration
  enumdomuser
  queryuser <user_rid>
  querygroup <group_rid>
```

---

### Enum4Linux

```shell
  ./enum4linux-ng.py <ip> -A
```

---

### NFS

```shell
  cat /etc/exports

  echo '/mnt/nfs  <ip>(sync,no_subtree_check)' >> /etc/exports
  systemctl restart nfs-kernel-server 
  exportfs-

  showmount -e <ip>

  mkdir NFS
  sudo mount -t nfs -v <targe_ip>:/var/nfs ./NFS/
  cat ./NFS/flag.txt

  ls -n mnt/nfs/
```

---

### DNS

```shell
  dig soa <domain_name>

  dig any inlanefreight.htb @<ip>

  dig CH TXT version.bind <ip>

  //dns zone transfer
  dig axfr inlanefreight.htb @<ip>

  dnsenum --dnsserver <ip> --enum -p 0 -s 0 -o subdomains.txt -f /opt/useful/seclists/Discovery/DNS/subdomains-top1million-110000.txt inlanefreight.htb

```

---

### SMTP

```shell
  telnet 10.129.14.128 25
  HELO <domain_name>
  EHLO <returned_from_output>
  VRFY <username>
```

---

### Imap/Pop3

```shell
  curl -k 'imaps://10.129.14.128' --user <username>:<password>

  openssl s_client -connect <ip>:pop3s
  openssl s_client -connect <ip>cu :imaps

  //Imap
  tag1 LOGIN <username> <password>
  tag1 LIST "" "*"
  tag1 SELECT <inbox_name>
  tag1 FETCH <number> (BODY[])

  //pop3
  USER <username>
  PASS <password>

  tbc...
```

---

### SNMP

```shell
  snmpwalk -v2c -c public <ip> | tee <output_filename>

  onesixtyone -c /opt/useful/seclists/Discovery/SNMP/snmp.txt <ip>

  braa <community string>@<IP>:.1.3.6.*
```

---

### MySQL

```shell
  mysql -u <username> -<password> -h <ip>

  //commands
  show databases;
  use <database_name>;
  show tables;
  show column from <table_name>;
  SELECT * FROM <table_name>
```

---

### MSSQL

```shell
  nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 <ip>

  python3 mssqlclient.py <username>@<ip> -windows-auth
  /usr/bin/impacket-mssqlclient <username>@<ip> -windows-auth

  //commands
  select name from sys.databases;

```

---

### Oracle TNS

Setup

```shell
  wget https://download.oracle.com/otn_software/linux/instantclient/214000/instantclient-basic-linux.x64-21.4.0.0.0dbru.zip
wget https://download.oracle.com/otn_software/linux/instantclient/214000/instantclient-sqlplus-linux.x64-21.4.0.0.0dbru.zip
sudo mkdir -p /opt/oracle
sudo unzip -d /opt/oracle instantclient-basic-linux.x64-21.4.0.0.0dbru.zip
sudo unzip -d /opt/oracle instantclient-sqlplus-linux.x64-21.4.0.0.0dbru.zip
export LD_LIBRARY_PATH=/opt/oracle/instantclient_21_4:$LD_LIBRARY_PATH
export PATH=$LD_LIBRARY_PATH:$PATH
source ~/.bashrc
cd ~
git clone https://github.com/quentinhardy/odat.git
cd odat/
pip install python-libnmap
git submodule init
git submodule update
pip3 install cx_Oracle
sudo apt-get install python3-scapy -y
sudo pip3 install colorlog termcolor passlib python-libnmap
sudo apt-get install build-essential libgmp-dev -y
pip3 install pycryptodome
```

Commands

```shell
  nmap -p1521 -sV <ip> --open --script oracle-sid-brute

  ./odat.py all -s 10.129.204.235

  sqlplus <usename>/<password>@<ip>/XE as sysdba

  ./odat.py utlfile -s <ip> -d XE -U scott -P tiger --sysdba --putFile C:\\inetpub\\wwwroot testing.txt ./testing.txt

  //command
  select table_name from all_tables;
  select * from user_role_privs
  select name, password from sys.user$
  select name, password from sys.user$ where name = <name>;

```

---

### IPMI

```shell

  msfconsole: use auxiliary/scanner/ipmi/ipmi_version
  msfconsole: use auxiliary/scanner/ipmi/ipmi_dumphashes 

  nmap -sU --script ipmi-version -p 623 <domain_name>

  hashcat -m 7300 -w 3 -O <password_hash> /usr/share/wordlists/rockyou.txt
```
