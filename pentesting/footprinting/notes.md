
# Footprinting

### FTP (Port: 21)

**Nmap Enumeration**
```shell
nmap -sV -p 21 --script ftp-anon,ftp-bounce,ftp-proftpd-backdoor,ftp-vsftpd-backdoor <ip>
````

**Manual Enumeration**

```shell
ftp <ip>
# Login with anonymous:anonymous

ls -la
cd <directory_name>
get <filename>
```

-----

### SMB (Ports: 139, 445)

**Nmap Enumeration**

```shell
nmap -p 139,445 --script smb-enum-shares,smb-enum-users,smb-os-discovery <ip>
```

**Manual Enumeration**

```shell
smbclient -N -L //<ip>
smbclient -N //<ip>/<share_name>

# Get user list
samrdump.py <ip>

# Enumerate shares and permissions
smbmap -H <ip>

# CrackMapExec for share enumeration
crackmapexec smb <ip> --shares -u '' -p ''

# Common commands within smbclient
get <filename>
put <filename>
ls
```

-----

### RpcClient (Port: 135)

**Nmap Enumeration**

```shell
nmap -p 135 --script rpcinfo <ip>
```

**Manual Enumeration**

```shell
rpcclient -U "" <ip>

# Client enumeration
srvinfo
enumdomains
querydomaininfo
netshareenumall
netsharegetinfo <share_name>
 
# User enumeration
enumdomusers
queryuser <user_rid>
querygroup <group_rid>
```

-----

### Enum4Linux

*This tool enumerates services like SMB (139, 445) and RPC (135).*

**Command**

```shell
enum4linux-ng.py <ip> -A
```

-----

### NFS (Ports: 111, 2049)

**Nmap Enumeration**

```shell
nmap -p 111,2049 --script nfs-ls,nfs-showmount,nfs-statfs <ip>
```

**Manual Enumeration**

```shell
# Check local exports (if setting up a share)
cat /etc/exports

# Show mountable shares on target
showmount -e <ip>

# Mount the remote share
mkdir /mnt/NFS
mount -t nfs <target_ip>:/<share_path> /mnt/NFS -o nolock
ls -la /mnt/NFS
```

-----

### DNS (Port: 53)

**Nmap Enumeration**

```shell
nmap -p 53 --script dns-zone-transfer,dns-brute <ip>
```

**Manual Enumeration**

```shell
# Standard query
dig any <domain_name> @<ip>

# Check service version
dig CH TXT version.bind @<ip>

# Attempt Zone Transfer
dig axfr <domain_name> @<ip>

# DNS Bruteforce with dnsenum
dnsenum --dnsserver <ip> --enum -f /path/to/wordlist.txt <domain_name>
```

-----

### SMTP (Ports: 25, 465, 587)

**Nmap Enumeration**

```shell
nmap -p 25,465,587 --script smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344 <ip>
```

**Manual Enumeration**

```shell
telnet <ip> 25
HELO <domain_name>
EHLO <domain_name>

# Attempt to verify users
VRFY <username>
RCPT TO <username>
```

-----

### IMAP (Ports: 143, 993) / POP3 (Ports: 110, 995)

**Nmap Enumeration**

```shell
# For IMAP
nmap -p 143,993 --script imap-capabilities,imap-ntlm-info <ip>

# For POP3
nmap -p 110,995 --script pop3-capabilities,pop3-ntlm-info <ip>
```

**Manual Enumeration**

```shell
# Connect with cURL (IMAPS)
curl -k 'imaps://<ip>' --user <username>:<password>

# Connect with OpenSSL (IMAPS)
openssl s_client -connect <ip>:imaps

# IMAP Commands
a1 LOGIN <username> <password>
a2 LIST "" "*"
a3 SELECT INBOX
a4 FETCH 1 BODY[]

# POP3 Commands
USER <username>
PASS <password>
LIST
RETR 1
```

-----

### SNMP (Port: 161/UDP)

**Nmap Enumeration**

```shell
nmap -sU -p 161 --script snmp-interfaces,snmp-netstat,snmp-processes <ip>
```

**Manual Enumeration**

```shell
# Brute-force community strings
onesixtyone -c /opt/useful/SecLists/Discovery/SNMP/snmp-onesixtyone.txt <ip>

# Walk the MIB tree with a known community string (e.g., 'public')
snmpwalk -v2c -c <found_community_string> <ip>
```

-----

### MySQL (Port: 3306)

**Nmap Enumeration**

```shell
nmap -p 3306 --script mysql-info,mysql-enum,mysql-dump-hashes <ip>
```

**Manual Enumeration**

```shell
mysql -u <username> -p<password> -h <ip>

# SQL Commands
show databases;
use <database_name>;
show tables;
select * from <table_name>;
```

-----

### MSSQL (Port: 1433)

**Nmap Enumeration**

```shell
nmap -p 1433 --script ms-sql-info,ms-sql-enum,ms-sql-xp-cmdshell -sV <ip>
```

**Manual Enumeration**

```shell
# Connect with impacket
impacket-mssqlclient <domain>/<username>:<password>@<ip> -windows-auth

# SQL Commands
help
select @@version;
select name from sys.databases;
xp_cmdshell 'whoami'
```

-----

### Oracle TNS (Port: 1521)

**Nmap Enumeration**

```shell
nmap -p 1521 --script oracle-sid-brute,oracle-tns-version <ip>
```

**Tool-based Enumeration (ODAT)**

```shell
./odat.py all -s <ip>
```

**Manual Connection**

```shell
sqlplus <username>/<password>@<ip>/<SID>

# SQL Commands
select table_name from all_tables;
select * from session_privs;
select name, password from sys.user$;
```

-----

### IPMI (Port: 623/UDP)

**Nmap Enumeration**

```shell
nmap -sU -p 623 --script ipmi-info,ipmi-version <ip>
```

**Metasploit Modules**

```shell
msfconsole
use auxiliary/scanner/ipmi/ipmi_version
set RHOSTS <ip>
run

use auxiliary/scanner/ipmi/ipmi_dumphashes
set RHOSTS <ip>
run
```

**Hash Cracking (Hashcat)**

```shell
# -m 7300 is for IPMI2 RAKP
hashcat -m 7300 <hash_file> /path/to/wordlist.txt
```

-----

### SSH (Port: 22)

**Nmap Enumeration**

```shell
nmap -p 22 --script ssh-auth-methods,ssh2-enum-algos,ssh-hostkey <ip>
```

**Manual Connection**

```shell
ssh <username>@<ip>
chmod 600 id_rsa
ssh -i <private_key_file> <username>@<ip>
```

-----

### RDP (Port: 3389)

**Nmap Enumeration**

```shell
nmap -p 3389 --script rdp-ntlm-info,rdp-enum-encryption <ip>
```

**Manual Connection**

```shell
xfreerdp /v:<ip> /u:<username> /p:'<password>'
```

```
```
