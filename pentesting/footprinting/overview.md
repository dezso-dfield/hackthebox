# The Ultimate Network Service Footprinting & Enumeration Cheat Sheet

This guide provides a comprehensive methodology for enumerating common network services. The focus is on a structured approach, starting with automated scanning and moving to deep manual enumeration, with a heavy emphasis on exploiting anonymous, guest, and null session access.

---

## üñ•Ô∏è General Purpose Tools

These tools are versatile and used across multiple service enumerations.

### `nmap`
* **Purpose**: The cornerstone of network discovery and security auditing. Used for host discovery, port scanning, and service/version detection.
* **Key Scripts**: NSE (Nmap Scripting Engine) scripts automate the discovery of vulnerabilities and misconfigurations.
* **Common Flags**:
    * `-sV`: Service/Version detection.
    * `-sC`: Run default scripts.
    * `-p-`: Scan all 65535 ports.
    * `-sU`: UDP scan.
    * `-oA`: Output in all formats.
    * `--script <script_name>`: Run a specific script.

### `crackmapexec` / `cme`
* **Purpose**: A post-exploitation tool that helps automate assessing the security of large Active Directory networks. Excellent for checking credentials and null/guest access across many hosts.

### `impacket` Scripts
* **Purpose**: A collection of Python classes for working with network protocols. Impacket's example scripts are essential for deep enumeration and exploitation of Windows environments.

---

## üìÅ File Transfer & Sharing Services

### FTP (Port: 21)
* **Goal**: To find sensitive files, configuration data, or writeable directories by checking for anonymous access.
* **Automated Enumeration (Nmap)**
    ```shell
    # -sV for version, --script to check for anonymous login and common backdoors
    nmap -sV -p 21 --script ftp-anon,ftp-bounce,ftp-proftpd-backdoor,ftp-vsftpd-backdoor <ip>
    ```
* **Manual Enumeration**
    ```shell
    # Connect to the FTP server
    ftp <ip>
    
    # Attempt anonymous login. User: anonymous, Pass: anonymous (or any email)
    
    # Common commands once logged in
    ls -la   # List files and directories with permissions
    cd       # Change directory
    get      # Download a file
    put      # Upload a file (if permissions allow)
    ```
* **Key Information**: Credentials in config files, user data, internal documents, potential pivot points via file upload.

### SMB (Ports: 139, 445)
* **Goal**: Enumerate shares, users, and permissions. This is a primary vector in Windows environments, often vulnerable to null/guest session enumeration.
* **Automated Enumeration (Nmap)**
    ```shell
    # --script to enumerate shares, users, OS, and check for vulnerabilities like MS17-010
    nmap -p 139,445 --script smb-enum-shares,smb-enum-users,smb-os-discovery,smb-vuln* <ip>
    ```
* **Tool-Based Enumeration**
    ```shell
    # Enumerate shares with null session (-N) or as guest
    smbclient -N -L //<ip>
    smbclient -U 'guest' -p '' -L //<ip>

    # Enumerate shares and permissions with smbmap
    smbmap -H <ip>
    
    # Dump user list via SAMR with a null session
    impacket-samrdump <ip>

    # Use CrackMapExec to quickly check for null session and list shares
    cme smb <ip> -u '' -p '' --shares
    ```
* **Manual Enumeration**
    ```shell
    # Connect to a specific share with a null session
    smbclient -N //<ip>/<share_name>
    
    # Common commands within smbclient
    ls         # List files
    get        # Download file
    mget * # Download all files
    put        # Upload file
    ```
* **Key Information**: Readable/writable shares, sensitive documents, software installers, user lists, domain information.

### NFS (Ports: 111, 2049)
* **Goal**: Find and mount exported network file systems, looking for sensitive data.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 111,2049 --script nfs-ls,nfs-showmount,nfs-statfs <ip>
    ```
* **Manual Enumeration**
    ```shell
    # List mountable shares on the target
    showmount -e <ip>

    # Mount the remote share locally
    mkdir /mnt/NFS
    # -o nolock is often needed for older NFS versions
    mount -t nfs <target_ip>:/<share_path> /mnt/NFS -o nolock
    
    # Check the contents
    ls -la /mnt/NFS
    
    # Unmount when done
    umount /mnt/NFS
    ```
* **Key Information**: User home directories, application data, backups, SSH keys. Check for `no_root_squash` which allows root access on the share.

---

##  Directory & Naming Services

### DNS (Port: 53)
* **Goal**: Attempt a zone transfer to map the entire internal network, or brute-force subdomains.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 53 --script dns-zone-transfer,dns-brute <ip> -sU -sT
    ```
* **Manual Enumeration**
    ```shell
    # Standard query for various record types
    dig any <domain_name> @<ip>

    # Attempt Zone Transfer (AXFR). A success is a critical finding.
    dig axfr <domain_name> @<ip>

    # Use dnsrecon for comprehensive enumeration
    dnsrecon -d <domain_name> -t axfr -n <ip>
    
    # Use dnsenum for brute-forcing subdomains
    dnsenum --dnsserver <ip> --enum -f /path/to/wordlist.txt <domain_name>
    ```
* **Key Information**: Full map of internal hosts and IPs, mail servers, nameservers, subdomains.

### LDAP (Ports: 389, 636)
* **Goal**: Query the directory service, often Active Directory, for users, groups, and domain structure. Anonymous binds are a common misconfiguration.
* **Automated Enumeration (Nmap)**
    ```shell
    # Dumps root DSE information, which reveals domain name and context
    nmap -p 389,636 --script ldap-rootdse <ip>
    ```
* **Manual Enumeration (Anonymous Bind)**
    ```shell
    # -x for simple authentication (anonymous), -H for URI, -b for base DN
    # This command attempts to dump the entire directory anonymously
    ldapsearch -x -H ldap://<ip> -b "DC=example,DC=com"
    
    # Search specifically for users
    ldapsearch -x -H ldap://<ip> -b "DC=example,DC=com" "(objectClass=user)"
    ```
* **Key Information**: Usernames, full names, descriptions, group memberships, computer names, domain policy.

---

## üåê Web & Remote Management Services

### HTTP/HTTPS (Ports: 80, 443)
* **Goal**: Identify web technologies, find vulnerabilities, and discover hidden files or directories.
* **Automated Enumeration**
    ```shell
    # Nmap for versions, default scripts, and vulnerability checks
    nmap -sV -p 80,443 --script http-enum,http-title,http-vuln* <ip>
    
    # Nikto for vulnerability scanning
    nikto -h http://<ip>
    ```
* **Manual Enumeration**
    ```shell
    # Directory and file brute-forcing is crucial
    gobuster dir -u http://<ip> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
    feroxbuster -u http://<ip> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html

    # Manually browse the site, check source code (Ctrl+U), view robots.txt
    curl http://<ip>/robots.txt
    ```
* **Key Information**: Admin panels, login pages, sensitive files (`.git`, `.env`, `config.php`), API endpoints, software versions.

### SSH (Port: 22)
* **Goal**: Check for weak credentials, outdated versions, or private keys left on other services.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 22 --script ssh-auth-methods,ssh2-enum-algos,ssh-hostkey <ip> -sV
    ```
* **Manual Enumeration & Brute-Force**
    ```shell
    # Attempt to connect
    ssh <username>@<ip>

    # Connect with a private key
    chmod 600 id_rsa
    ssh -i id_rsa <username>@<ip>
    
    # Brute-force credentials with Hydra
    hydra -L users.txt -P passwords.txt ssh://<ip>
    ```
* **Key Information**: Authentication methods allowed (password, pubkey), software version, successful login.

### RDP (Port: 3389)
* **Goal**: Identify OS version, check for vulnerabilities, and attempt to gain GUI access.
* **Automated Enumeration (Nmap)**
    ```shell
    # Check NTLM info, encryption levels, and common vulnerabilities
    nmap -p 3389 --script rdp-ntlm-info,rdp-enum-encryption,rdp-vuln-ms12-020 <ip>
    ```
* **Manual Connection & Brute-Force**
    ```shell
    # Connect with xfreerdp (Linux)
    xfreerdp /v:<ip> /u:<username> /p:'<password>'
    xfreerdp /v:<ip> /u:<username> /p:'<password>' /dynamic-resolution /drive:linux,.
    
    # Brute-force with Crowbar
    crowbar -b rdp -s <ip>/32 -U users.txt -C passwords.txt
    ```
* **Key Information**: Full domain name, OS version, vulnerabilities (e.g., BlueKeep), successful GUI access.

### WinRM (Ports: 5985, 5986)
* **Goal**: Gain remote shell access on modern Windows systems.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 5985,5986 --script http-title,http-winrm <ip>
    ```
* **Tool-Based Enumeration & Connection**
    ```shell
    # Check for valid credentials with CrackMapExec
    cme winrm <ip> -u <user> -p <pass>
    
    # Connect with Evil-WinRM
    evil-winrm -i <ip> -u <user> -p <pass>
    ```
* **Key Information**: PowerShell access to the target system.

### Telnet (Port: 23)
* **Goal**: Identify the service and check for anonymous/default login.
* **Manual Enumeration**
    ```shell
    # Connect and observe the banner
    telnet <ip> 23
    # Try common default credentials (root:root, admin:admin, etc.)
    ```
* **Key Information**: Device type, software version, potential for unencrypted remote shell.

---

## üìß Mail Services

### SMTP (Ports: 25, 465, 587)
* **Goal**: Enumerate valid usernames/email addresses.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 25,465,587 --script smtp-commands,smtp-enum-users <ip>
    ```
* **Manual Enumeration**
    ```shell
    # Connect and check for user enumeration commands
    telnet <ip> 25
    HELO example.com
    
    # VRFY (Verify) and EXPN (Expand) are often disabled but worth trying
    VRFY <username>
    
    # RCPT TO (Recipient To) is a more reliable method
    MAIL FROM: user@example.com
    RCPT TO: <username_to_check>
    # Look for response codes: 250/252 = User exists, 550 = User does not exist
    ```
* **Key Information**: A list of valid email addresses.

### IMAP (143, 993) / POP3 (110, 995)
* **Goal**: Check for weak credentials to access mailboxes.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 143,993,110,995 --script "*-ntlm-info" <ip>
    ```
* **Manual Enumeration**
    ```shell
    # Connect to IMAPS with OpenSSL to check capabilities
    openssl s_client -connect <ip>:993
    
    # IMAP Commands after connecting
    a1 LOGIN <username> <password>
    a2 LIST "" "*"          # List mailboxes
    a3 SELECT INBOX         # Select the inbox
    a4 FETCH 1 BODY[]       # Fetch the body of the first email
    ```
* **Key Information**: Access to sensitive emails, password resets, internal communications.

---

## üì¶ Database Services

### MySQL (Port: 3306)
* **Goal**: Find default or weak credentials to access databases.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 3306 --script mysql-info,mysql-enum,mysql-dump-hashes <ip> -sV
    ```
* **Manual Enumeration**
    ```shell
    # Attempt to connect with default/blank root password
    mysql -u root -h <ip>
    
    # Common SQL commands
    show databases;
    use <database_name>;
    show tables;
    select user, host, password from mysql.user; # Check for user hashes
    ```
* **Key Information**: User credentials, application data, PII.

### MSSQL (Port: 1433)
* **Goal**: Find weak credentials and leverage database features for command execution.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 1433 --script ms-sql-info,ms-sql-enum,ms-sql-xp-cmdshell <ip> -sV
    ```
* **Manual Enumeration**
    ```shell
    # Connect with impacket's mssqlclient (handles Windows auth)
    impacket-mssqlclient <domain>/<username>:<password>@<ip> -windows-auth

    # Check if xp_cmdshell is enabled for command execution
    # This is a critical finding if successful
    xp_cmdshell 'whoami'
    ```
* **Key Information**: Database contents, ability to execute OS commands on the server.

### Oracle (Port: 1521)
* **Goal**: Find default SIDs and credentials to access databases.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 1521 --script oracle-sid-brute,oracle-tns-version <ip>
    ```
* **Tool-Based Enumeration**
    ```shell
    # ODAT is the go-to tool for comprehensive Oracle testing
    ./odat.py all -s <ip>
    ```
* **Key Information**: SIDs, user credentials, database contents.

---

## üî© Low-Level & Infrastructure Services

### RpcClient & RPCBind (Ports: 135, 111)
* **Goal**: Enumerate RPC endpoints to understand available services and perform null-session enumeration against Windows hosts.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -p 135,111 --script rpcinfo,rpc-grind <ip>
    ```
* **Manual Enumeration (Windows RPC)**
    ```shell
    # Connect with a null session (-U "")
    rpcclient -U "" <ip>

    # Enumerate domain and user info
    srvinfo
    enumdomains
    querydomaininfo
    enumdomusers
    # Cycle through RIDs to find users (e.g., 500=Administrator, 501=Guest)
    queryuser 500
    ```
* **Key Information**: Domain name, usernames, group names, running services.

### SNMP (Port: 161/UDP)
* **Goal**: Find systems with default community strings ('public', 'private') to extract configuration and network information.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -sU -p 161 --script snmp-interfaces,snmp-netstat,snmp-processes <ip>
    ```
* **Manual Enumeration**
    ```shell
    # Brute-force community strings
    onesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt <ip>

    # Walk the entire MIB tree with a known community string
    snmpwalk -v2c -c <found_community_string> <ip>
    
    # Use snmp-check for a more readable output
    snmp-check -c <found_community_string> <ip>
    ```
* **Key Information**: Hostnames, usernames, network routes, running processes, system uptime.

### IPMI (Port: 623/UDP)
* **Goal**: Check for weak credentials or vulnerabilities in the out-of-band management interface, which could allow full server control.
* **Automated Enumeration (Nmap)**
    ```shell
    nmap -sU -p 623 --script ipmi-info,ipmi-version <ip>
    ```
* **Tool-Based Enumeration (Metasploit)**
    ```shell
    msfconsole
    use auxiliary/scanner/ipmi/ipmi_version
    set RHOSTS <ip>
    run
    
    # Attempt to dump password hashes (often weak or default)
    use auxiliary/scanner/ipmi/ipmi_dumphashes
    set RHOSTS <ip>
    run
    ```
* **Hash Cracking**
    ```shell
    # Crack dumped hashes with Hashcat (mode 7300 is IPMI2 RAKP)
    hashcat -m 7300 ipmi_hashes.txt /path/to/wordlist.txt
    ```
* **Key Information**: Ability to remotely power on/off a server, access its console, and potentially retrieve credentials.
