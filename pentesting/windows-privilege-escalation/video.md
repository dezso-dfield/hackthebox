Of course. Here is an expanded cheat sheet that includes more tools like `netexec` and `ffuf`, and covers a wider range of common ports and services.

**Disclaimer:** These commands are for educational and authorized security testing purposes only. Always obtain explicit, written permission from the system owner before scanning or testing any network or system.

-----

### Initial Reconnaissance üì°

This command chain performs a fast, full port scan, followed by a service and script scan on discovered ports, and finally a vulnerability scan.

```shell
nmap -p- -Pn <target> -v -T5 --min-rate 1000 -oN nmap_ports.txt && \
nmap -p$(grep -oP '\d{1,5}/open' nmap_ports.txt | cut -d'/' -f1 | tr '\n' ',') -Pn <target> -sC -sV -v -oN nmap_sVsC.txt && \
nmap -p$(grep -oP '\d{1,5}/open' nmap_ports.txt | cut -d'/' -f1 | tr '\n' ',') -Pn <target> -v --script vuln -oN nmap_vuln.txt
```

-----

### Web Ports (80, 443, 8080, etc.) üï∏Ô∏è

**Directory, File, and vHost Fuzzing:**
`ffuf` (Fuzz Faster U Fool) is an extremely fast and versatile fuzzer.

```shell
# Fuzz for directories
ffuf -w /path/to/wordlist.txt -u http://<target>/FUZZ

# Fuzz for files with specific extensions
ffuf -w /path/to/wordlist.txt -u http://<target>/FUZZ.php -e .html,.txt,.bak

# Fuzz for subdomains (Virtual Hosts)
ffuf -w /path/to/subdomains.txt -u http://<target> -H "Host: FUZZ.<domain>" -fs <size_of_default_response>

# Fuzz for POST parameters
ffuf -w /path/to/params.txt -u http://<target>/login -X POST -d "user=admin&FUZZ=test"
```

**Vulnerability Scanning:**

```shell
# Nikto for common web server vulnerabilities
nikto -h http://<target>

# WhatWeb to identify technologies
whatweb http://<target>
```

-----

### SMB (Port 445) & Windows Services üíª

`netexec` (the successor to `crackmapexec`) is a powerful tool for pentesting Windows/Active Directory environments.

```shell
# Basic enumeration: list shares, sessions, users, password policy
netexec smb <target_or_subnet>

# Check for null sessions (unauthenticated access)
netexec smb <target> -u '' -p ''

# List shares with anonymous/null session
netexec smb <target> -u '' -p '' --shares

# Dump SAM hashes (requires admin credentials)
netexec smb <target> -u <user> -p <password> --sam

# Execute a command (requires admin credentials)
netexec smb <target> -u <user> -p <password> -x "whoami"
```

-----

### WinRM (Ports 5985, 5986) ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£

Windows Remote Management is another way to manage Windows machines.

```shell
# Check for credentials
netexec winrm <target> -u <userlist> -p <passwordlist>

# Execute commands with valid credentials
netexec winrm <target> -u <user> -p <password> -x "ipconfig"
```

-----

### LDAP (Port 389) üìá

Enumerate Active Directory domains for users, groups, and computers.

```shell
# Enumerate the domain with anonymous bind
ldapsearch -x -h <target> -b "DC=example,DC=com"

# Using netexec for LDAP enumeration (anonymous bind)
netexec ldap <target> -u '' -p ''

# Enumerate domain users with credentials
netexec ldap <target> -u <user> -p <password> --users

# Enumerate domain groups
netexec ldap <target> -u <user> -p <password> --groups
```

-----

### DNS (Port 53) üåê

Check for zone transfers, which can leak all DNS records for a domain.

```shell
# Attempt a zone transfer using dig
dig axfr @<target> <domain_name>

# Attempt a zone transfer using dnsrecon
dnsrecon -d <domain_name> -t axfr -n <target>

# Brute-force subdomains
dnsrecon -d <domain_name> -t brt -w /path/to/wordlist.txt
```

-----

### Mail Services (SMTP 25, POP3 110, IMAP 143) üìß

```shell
# SMTP: Enumerate valid users using VRFY/EXPN
nmap -p 25 --script smtp-commands,smtp-enum-users <target>

# Connect with netcat to manually check SMTP commands
nc -nv <target> 25

# IMAP: Check capabilities and login methods
nmap -p 143 --script imap-capabilities <target>

# POP3: Check capabilities
nmap -p 110 --script pop3-capabilities <target>
```

-----

### SNMP (Port 161) üìä

Simple Network Management Protocol can leak a massive amount of information if misconfigured with default community strings like `public` or `private`.

```shell
# Use snmp-check to dump all available info
snmp-check -t <target> -c public

# Use snmpwalk to "walk" the MIB tree
snmpwalk -c public -v1 <target>
```

-----

### Databases (MySQL 3306, PostgreSQL 5432, MSSQL 1433) üíæ

```shell
# MySQL: Check version, info, and look for default credentials
nmap -p 3306 --script mysql-info,mysql-empty-password,mysql-vuln-cve2012-2122 <target>

# PostgreSQL: Check for authentication methods
nmap -p 5432 --script pgsql-info <target>

# MSSQL: Enumerate and check for vulnerabilities
nmap -p 1433 --script ms-sql-info,ms-sql-config,ms-sql-empty-password <target>

# Use netexec for MSSQL
netexec mssql <target> -u <user> -p <password> --queries "SELECT @@version"
```

-----

### Remote Access (RDP 3389) üñ•Ô∏è

Remote Desktop Protocol. Check for vulnerabilities and weak credentials.

```shell
# Check for weak credentials using nmap
nmap -p 3389 --script rdp-ntlm-info <target>

# Check for the BlueKeep vulnerability (CVE-2019-0708)
nmap -p 3389 --script rdp-vuln-ms12-020 <target>
```

Of course. Here are some common follow-up commands for reconnaissance and enumeration based on open ports, presented for educational and ethical security testing purposes. Always ensure you have explicit, written permission before scanning any system.

### Initial Reconnaissance

This command chain performs a fast, full port scan, followed by a service and script scan on discovered ports, and finally a vulnerability scan.

```shell
nmap -p- -Pn <target> -v -T5 --min-rate 1000 -oN nmap_ports.txt && \
nmap -p$(grep -oP '\d{1,5}/open' nmap_ports.txt | cut -d'/' -f1 | tr '\n' ',') -Pn <target> -sC -sV -v -oN nmap_sVsC.txt && \
nmap -p$(grep -oP '\d{1,5}/open' nmap_ports.txt | cut -d'/' -f1 | tr '\n' ',') -Pn <target> -v --script vuln -oN nmap_vuln.txt
```

-----

### Web Ports (80, 443, 8080, etc.) üï∏Ô∏è

If a web server is found, the next steps involve directory/file fuzzing, technology identification, and vulnerability scanning.

**Recommended Wordlists:**

  * `SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt`
  * `SecLists/Discovery/Web-Content/common.txt`
  * `/usr/share/wordlists/dirb/common.txt` (Often built-in with Kali Linux)

**Directory & File Fuzzing (Content Discovery):**
Use tools like `gobuster` or `feroxbuster` to find hidden directories and files.

```shell
# Gobuster for directory discovery
gobuster dir -u http://<target> -w /path/to/wordlist.txt -x php,txt,html -o gobuster_results.txt

# Feroxbuster for recursive directory discovery
feroxbuster -u http://<target> -w /path/to/wordlist.txt -x php,txt,html --depth 3 -o feroxbuster_results.txt
```

**Virtual Host Fuzzing (Subdomain Discovery):**
Discover subdomains configured on the same web server.

```shell
# Fuzz for vhosts using gobuster
gobuster vhost -u http://<target> -w /path/to/subdomains.txt --append-domain

# Fuzz for vhosts using ffuf
ffuf -w /path/to/subdomains.txt -u http://<target> -H "Host: FUZZ.<target>" -fs <size_of_default_response>
```

**Vulnerability Scanning & Tech Identification:**
Run specialized web scanners to identify technologies and common vulnerabilities.

```shell
# Nikto for common web server vulnerabilities
nikto -h http://<target> -o nikto_results.txt

# WhatWeb to identify technologies
whatweb http://<target>
```

-----

### SMB (Port 445) üìÅ

Server Message Block is often used for file sharing. Enumeration can reveal shares, users, and potential vulnerabilities.

```shell
# List shares and check for anonymous access
smbclient -L //<target>/ -N

# Enumerate everything possible with enum4linux-ng
enum4linux-ng -A <target>

# Check for the EternalBlue vulnerability (MS17-010)
nmap --script smb-vuln-ms17-010 -p445 <target>
```

-----

### FTP (Port 21) üìú

File Transfer Protocol. Always check for anonymous login.

```shell
# Try to log in as 'anonymous' with an empty password
ftp <target>
# User: anonymous
# Pass: <enter>

# Nmap scripts for FTP
nmap -p 21 --script ftp-anon,ftp-vuln-cve2010-4221 <target>
```

-----

### SSH (Port 22) üîí

Secure Shell. Check for weak credentials or old versions.

```shell
# Check SSH version and supported authentication methods
nmap -p 22 --script ssh2-enum-algos <target>

# Brute-force with a small, common user/pass list (use with caution)
hydra -L users.txt -P passwords.txt ssh://<target>
```

-----

### Telnet (Port 23) ‚å®Ô∏è

An unencrypted remote login protocol. Often allows default or weak credentials.

```shell
# Simply try to connect
telnet <target>
```

-----

### RPC (Port 135) & RPCBind (Port 111) üîó

Remote Procedure Call services. Enumerate to see what services are available.

```shell
# Enumerate RPC services
rpcinfo -p <target>

# Nmap scripts for RPC
nmap -p 111,135 --script rpcinfo,rpc-grind <target>
```

-----

### LDAP (Port 389) üìá

Lightweight Directory Access Protocol. Used for accessing directory services. Check for anonymous binds to extract information.

```shell
# Perform a basic anonymous bind search
ldapsearch -x -h <target> -b "dc=example,dc=com"

# Nmap scripts for LDAP
nmap -p 389 --script ldap-search,ldap-rootdse <target>
```
